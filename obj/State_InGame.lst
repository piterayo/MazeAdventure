                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 3.5.5 #9498 (Linux)
                              4 ;--------------------------------------------------------
                              5 	.module State_InGame
                              6 	.optsdcc -mz80
                              7 	
                              8 ;--------------------------------------------------------
                              9 ; Public variables in this module
                             10 ;--------------------------------------------------------
                             11 	.globl _ui_playerstats_render
                             12 	.globl _ui_gamemenu_render_refresh
                             13 	.globl _ui_gamemenu_render_all
                             14 	.globl _ui_gamemenu_unselect_entry
                             15 	.globl _ui_gamemenu_select_entry
                             16 	.globl _ui_gamemenu_below_entry
                             17 	.globl _ui_gamemenu_above_entry
                             18 	.globl _ui_gamemenu_previous_entry
                             19 	.globl _ui_gamemenu_next_entry
                             20 	.globl _ui_gamemenu_is_selected
                             21 	.globl _ui_gamemenu_get_entry
                             22 	.globl _ui_gamemenu_get_movement
                             23 	.globl _ui_gamemenu_get_action
                             24 	.globl _ui_gamemenu_update_action
                             25 	.globl _ui_gamemenu_init
                             26 	.globl _renderCompass
                             27 	.globl _level_get_level
                             28 	.globl _level_set_level
                             29 	.globl _draw_minimap_to_buffer
                             30 	.globl _render_draw_to_buffer
                             31 	.globl _player_move_forward
                             32 	.globl _player_turn_right
                             33 	.globl _player_turn_left
                             34 	.globl _statemanager_input_accepted
                             35 	.globl _statemanager_set_state
                             36 	.globl _statemanager_close_state
                             37 	.globl _cpct_drawSprite
                             38 	.globl _cpct_isKeyPressed
                             39 	.globl _cpct_memset
                             40 	.globl _updateRenderBuffer
                             41 	.globl _state_ingame_enter
                             42 	.globl _state_ingame_return
                             43 	.globl _state_ingame_input
                             44 	.globl _state_ingame_update
                             45 	.globl _state_ingame_render
                             46 	.globl _state_ingame_exit
                             47 ;--------------------------------------------------------
                             48 ; special function registers
                             49 ;--------------------------------------------------------
                             50 ;--------------------------------------------------------
                             51 ; ram data
                             52 ;--------------------------------------------------------
                             53 	.area _DATA
                             54 ;--------------------------------------------------------
                             55 ; ram data
                             56 ;--------------------------------------------------------
                             57 	.area _INITIALIZED
                             58 ;--------------------------------------------------------
                             59 ; absolute external ram data
                             60 ;--------------------------------------------------------
                             61 	.area _DABS (ABS)
                             62 ;--------------------------------------------------------
                             63 ; global & static initialisations
                             64 ;--------------------------------------------------------
                             65 	.area _HOME
                             66 	.area _GSINIT
                             67 	.area _GSFINAL
                             68 	.area _GSINIT
                             69 ;--------------------------------------------------------
                             70 ; Home
                             71 ;--------------------------------------------------------
                             72 	.area _HOME
                             73 	.area _HOME
                             74 ;--------------------------------------------------------
                             75 ; code
                             76 ;--------------------------------------------------------
                             77 	.area _CODE
                             78 ;src/State_InGame.c:21: void state_ingame_enter(){
                             79 ;	---------------------------------
                             80 ; Function state_ingame_enter
                             81 ; ---------------------------------
   0000                      82 _state_ingame_enter::
                             83 ;src/State_InGame.c:22: cpct_memset(CPCT_VMEM_START, g_colors[1], 0x4000);
   0000 21r01r00      [10]   84 	ld	hl, #(_g_colors + 0x0001) + 0
   0003 46            [ 7]   85 	ld	b,(hl)
   0004 21 00 40      [10]   86 	ld	hl,#0x4000
   0007 E5            [11]   87 	push	hl
   0008 C5            [11]   88 	push	bc
   0009 33            [ 6]   89 	inc	sp
   000A 26 C0         [ 7]   90 	ld	h, #0xC0
   000C E5            [11]   91 	push	hl
   000D CDr00r00      [17]   92 	call	_cpct_memset
                             93 ;src/State_InGame.c:24: ui_gamemenu_init();
   0010 CDr00r00      [17]   94 	call	_ui_gamemenu_init
                             95 ;src/State_InGame.c:25: ui_gamemenu_render_all();
   0013 CDr00r00      [17]   96 	call	_ui_gamemenu_render_all
                             97 ;src/State_InGame.c:26: state_ingame_render();
   0016 CDr42r01      [17]   98 	call	_state_ingame_render
   0019 C9            [10]   99 	ret
   001A                     100 _updateRenderBuffer:
   001A 00                  101 	.db #0x00	; 0
                            102 ;src/State_InGame.c:29: void state_ingame_return(){
                            103 ;	---------------------------------
                            104 ; Function state_ingame_return
                            105 ; ---------------------------------
   001B                     106 _state_ingame_return::
                            107 ;src/State_InGame.c:30: ui_gamemenu_render_all();
   001B CDr00r00      [17]  108 	call	_ui_gamemenu_render_all
                            109 ;src/State_InGame.c:31: state_ingame_render();
   001E C3r42r01      [10]  110 	jp  _state_ingame_render
                            111 ;src/State_InGame.c:34: void state_ingame_input(){
                            112 ;	---------------------------------
                            113 ; Function state_ingame_input
                            114 ; ---------------------------------
   0021                     115 _state_ingame_input::
                            116 ;src/State_InGame.c:36: if(cpct_isKeyPressed(Key_CursorLeft)){
   0021 21 01 01      [10]  117 	ld	hl,#0x0101
   0024 CDr00r00      [17]  118 	call	_cpct_isKeyPressed
   0027 7D            [ 4]  119 	ld	a,l
   0028 B7            [ 4]  120 	or	a, a
   0029 28 06         [12]  121 	jr	Z,00116$
                            122 ;src/State_InGame.c:37: ui_gamemenu_previous_entry();
   002B CDr00r00      [17]  123 	call	_ui_gamemenu_previous_entry
                            124 ;src/State_InGame.c:38: statemanager_input_accepted();
   002E C3r00r00      [10]  125 	jp  _statemanager_input_accepted
   0031                     126 00116$:
                            127 ;src/State_InGame.c:40: else if(cpct_isKeyPressed(Key_CursorRight)){
   0031 21 00 02      [10]  128 	ld	hl,#0x0200
   0034 CDr00r00      [17]  129 	call	_cpct_isKeyPressed
   0037 7D            [ 4]  130 	ld	a,l
   0038 B7            [ 4]  131 	or	a, a
   0039 28 06         [12]  132 	jr	Z,00113$
                            133 ;src/State_InGame.c:41: ui_gamemenu_next_entry();
   003B CDr00r00      [17]  134 	call	_ui_gamemenu_next_entry
                            135 ;src/State_InGame.c:42: statemanager_input_accepted();
   003E C3r00r00      [10]  136 	jp  _statemanager_input_accepted
   0041                     137 00113$:
                            138 ;src/State_InGame.c:44: else if(cpct_isKeyPressed(Key_CursorUp)){
   0041 21 00 01      [10]  139 	ld	hl,#0x0100
   0044 CDr00r00      [17]  140 	call	_cpct_isKeyPressed
   0047 7D            [ 4]  141 	ld	a,l
   0048 B7            [ 4]  142 	or	a, a
   0049 28 06         [12]  143 	jr	Z,00110$
                            144 ;src/State_InGame.c:45: ui_gamemenu_above_entry();
   004B CDr00r00      [17]  145 	call	_ui_gamemenu_above_entry
                            146 ;src/State_InGame.c:46: statemanager_input_accepted();
   004E C3r00r00      [10]  147 	jp  _statemanager_input_accepted
   0051                     148 00110$:
                            149 ;src/State_InGame.c:48: else if(cpct_isKeyPressed(Key_CursorDown)){
   0051 21 00 04      [10]  150 	ld	hl,#0x0400
   0054 CDr00r00      [17]  151 	call	_cpct_isKeyPressed
   0057 7D            [ 4]  152 	ld	a,l
   0058 B7            [ 4]  153 	or	a, a
   0059 28 06         [12]  154 	jr	Z,00107$
                            155 ;src/State_InGame.c:49: ui_gamemenu_below_entry();
   005B CDr00r00      [17]  156 	call	_ui_gamemenu_below_entry
                            157 ;src/State_InGame.c:50: statemanager_input_accepted();
   005E C3r00r00      [10]  158 	jp  _statemanager_input_accepted
   0061                     159 00107$:
                            160 ;src/State_InGame.c:52: else if(cpct_isKeyPressed(Key_Return)){
   0061 21 02 04      [10]  161 	ld	hl,#0x0402
   0064 CDr00r00      [17]  162 	call	_cpct_isKeyPressed
   0067 7D            [ 4]  163 	ld	a,l
   0068 B7            [ 4]  164 	or	a, a
   0069 28 06         [12]  165 	jr	Z,00104$
                            166 ;src/State_InGame.c:53: ui_gamemenu_select_entry();
   006B CDr00r00      [17]  167 	call	_ui_gamemenu_select_entry
                            168 ;src/State_InGame.c:54: statemanager_input_accepted();
   006E C3r00r00      [10]  169 	jp  _statemanager_input_accepted
   0071                     170 00104$:
                            171 ;src/State_InGame.c:57: else if(cpct_isKeyPressed(Key_T)){
   0071 21 06 08      [10]  172 	ld	hl,#0x0806
   0074 CDr00r00      [17]  173 	call	_cpct_isKeyPressed
   0077 7D            [ 4]  174 	ld	a,l
   0078 B7            [ 4]  175 	or	a, a
   0079 C8            [11]  176 	ret	Z
                            177 ;src/State_InGame.c:58: *(u8*)&g_texturedWalls = !g_texturedWalls;
   007A 3Ar00r00      [13]  178 	ld	a,(#_g_texturedWalls + 0)
   007D D6 01         [ 7]  179 	sub	a,#0x01
   007F 3E 00         [ 7]  180 	ld	a,#0x00
   0081 17            [ 4]  181 	rla
   0082 4F            [ 4]  182 	ld	c,a
   0083 21r00r00      [10]  183 	ld	hl,#_g_texturedWalls
   0086 71            [ 7]  184 	ld	(hl),c
                            185 ;src/State_InGame.c:59: statemanager_input_accepted();
   0087 C3r00r00      [10]  186 	jp  _statemanager_input_accepted
                            187 ;src/State_InGame.c:63: void state_ingame_update(){
                            188 ;	---------------------------------
                            189 ; Function state_ingame_update
                            190 ; ---------------------------------
   008A                     191 _state_ingame_update::
                            192 ;src/State_InGame.c:66: if(ui_gamemenu_is_selected()){
   008A CDr00r00      [17]  193 	call	_ui_gamemenu_is_selected
   008D 7D            [ 4]  194 	ld	a,l
   008E B7            [ 4]  195 	or	a, a
   008F CAr31r01      [10]  196 	jp	Z,00116$
                            197 ;src/State_InGame.c:67: ui_gamemenu_render_refresh();
   0092 CDr00r00      [17]  198 	call	_ui_gamemenu_render_refresh
                            199 ;src/State_InGame.c:68: switch(ui_gamemenu_get_entry()){
   0095 CDr00r00      [17]  200 	call	_ui_gamemenu_get_entry
   0098 5D            [ 4]  201 	ld	e,l
   0099 3E 06         [ 7]  202 	ld	a,#0x06
   009B 93            [ 4]  203 	sub	a, e
   009C DAr2Er01      [10]  204 	jp	C,00114$
   009F 16 00         [ 7]  205 	ld	d,#0x00
   00A1 21rA8r00      [10]  206 	ld	hl,#00145$
   00A4 19            [11]  207 	add	hl,de
   00A5 19            [11]  208 	add	hl,de
   00A6 19            [11]  209 	add	hl,de
   00A7 E9            [ 4]  210 	jp	(hl)
   00A8                     211 00145$:
   00A8 C3rBDr00      [10]  212 	jp	00101$
   00AB C3r2Er01      [10]  213 	jp	00114$
   00AE C3rF8r00      [10]  214 	jp	00107$
   00B1 C3r05r01      [10]  215 	jp	00108$
   00B4 C3r19r01      [10]  216 	jp	00111$
   00B7 C3r2Er01      [10]  217 	jp	00114$
   00BA C3r26r01      [10]  218 	jp	00113$
                            219 ;src/State_InGame.c:69: case 0:{//ACTION BUTTON
   00BD                     220 00101$:
                            221 ;src/State_InGame.c:71: switch(ui_gamemenu_get_action()){
   00BD CDr00r00      [17]  222 	call	_ui_gamemenu_get_action
   00C0 5D            [ 4]  223 	ld	e,l
   00C1 7B            [ 4]  224 	ld	a,e
   00C2 D6 01         [ 7]  225 	sub	a, #0x01
   00C4 38 68         [12]  226 	jr	C,00114$
   00C6 3E 03         [ 7]  227 	ld	a,#0x03
   00C8 93            [ 4]  228 	sub	a, e
   00C9 38 63         [12]  229 	jr	C,00114$
   00CB 1D            [ 4]  230 	dec	e
   00CC 16 00         [ 7]  231 	ld	d,#0x00
   00CE 21rD4r00      [10]  232 	ld	hl,#00146$
   00D1 19            [11]  233 	add	hl,de
   00D2 19            [11]  234 	add	hl,de
                            235 ;src/State_InGame.c:72: case 1:{
   00D3 E9            [ 4]  236 	jp	(hl)
   00D4                     237 00146$:
   00D4 18 04         [12]  238 	jr	00102$
   00D6 18 56         [12]  239 	jr	00114$
   00D8 18 54         [12]  240 	jr	00114$
   00DA                     241 00102$:
                            242 ;src/State_InGame.c:73: level_set_level(level_get_level()+1);
   00DA CDr00r00      [17]  243 	call	_level_get_level
   00DD 45            [ 4]  244 	ld	b,l
   00DE 04            [ 4]  245 	inc	b
   00DF C5            [11]  246 	push	bc
   00E0 33            [ 6]  247 	inc	sp
   00E1 CDr00r00      [17]  248 	call	_level_set_level
   00E4 33            [ 6]  249 	inc	sp
                            250 ;src/State_InGame.c:74: statemanager_close_state();
   00E5 CDr00r00      [17]  251 	call	_statemanager_close_state
                            252 ;src/State_InGame.c:75: statemanager_set_state(STATE_LOADLEVEL);
   00E8 3E 03         [ 7]  253 	ld	a,#0x03
   00EA F5            [11]  254 	push	af
   00EB 33            [ 6]  255 	inc	sp
   00EC CDr00r00      [17]  256 	call	_statemanager_set_state
   00EF 33            [ 6]  257 	inc	sp
                            258 ;src/State_InGame.c:77: break;
   00F0 18 3C         [12]  259 	jr	00114$
                            260 ;src/State_InGame.c:79: case 2:{
                            261 ;src/State_InGame.c:81: break;
   00F2 18 3A         [12]  262 	jr	00114$
                            263 ;src/State_InGame.c:83: case 3:{
                            264 ;src/State_InGame.c:88: break;
   00F4 18 38         [12]  265 	jr	00114$
                            266 ;src/State_InGame.c:90: case 1:{//INVENTORY
                            267 ;src/State_InGame.c:93: break;
   00F6 18 36         [12]  268 	jr	00114$
                            269 ;src/State_InGame.c:95: case 2:{//TURN LEFT
   00F8                     270 00107$:
                            271 ;src/State_InGame.c:97: player_turn_left();
   00F8 CDr00r00      [17]  272 	call	_player_turn_left
                            273 ;src/State_InGame.c:98: ui_gamemenu_update_action();
   00FB CDr00r00      [17]  274 	call	_ui_gamemenu_update_action
                            275 ;src/State_InGame.c:100: *(u8*)&updateRenderBuffer = 1;
   00FE 21r1Ar00      [10]  276 	ld	hl,#_updateRenderBuffer
   0101 36 01         [10]  277 	ld	(hl),#0x01
                            278 ;src/State_InGame.c:101: break;
   0103 18 29         [12]  279 	jr	00114$
                            280 ;src/State_InGame.c:103: case 3:{//MOVE
   0105                     281 00108$:
                            282 ;src/State_InGame.c:104: if(ui_gamemenu_get_movement()){//BYPASS IF FOR NOCLIP
   0105 CDr00r00      [17]  283 	call	_ui_gamemenu_get_movement
   0108 7D            [ 4]  284 	ld	a,l
   0109 B7            [ 4]  285 	or	a, a
   010A 28 22         [12]  286 	jr	Z,00114$
                            287 ;src/State_InGame.c:105: player_move_forward();
   010C CDr00r00      [17]  288 	call	_player_move_forward
                            289 ;src/State_InGame.c:106: ui_gamemenu_update_action();
   010F CDr00r00      [17]  290 	call	_ui_gamemenu_update_action
                            291 ;src/State_InGame.c:107: *(u8*)&updateRenderBuffer = 1;
   0112 21r1Ar00      [10]  292 	ld	hl,#_updateRenderBuffer
   0115 36 01         [10]  293 	ld	(hl),#0x01
                            294 ;src/State_InGame.c:109: break;
   0117 18 15         [12]  295 	jr	00114$
                            296 ;src/State_InGame.c:111: case 4:{//TURN RIGHT
   0119                     297 00111$:
                            298 ;src/State_InGame.c:112: player_turn_right();
   0119 CDr00r00      [17]  299 	call	_player_turn_right
                            300 ;src/State_InGame.c:113: ui_gamemenu_update_action();
   011C CDr00r00      [17]  301 	call	_ui_gamemenu_update_action
                            302 ;src/State_InGame.c:115: *(u8*)&updateRenderBuffer = 1;
   011F 21r1Ar00      [10]  303 	ld	hl,#_updateRenderBuffer
                            304 ;src/State_InGame.c:117: break;
                            305 ;src/State_InGame.c:119: case 5:{//WAIT
                            306 ;src/State_InGame.c:121: break;
   0122 36 01         [10]  307 	ld	(hl), #0x01
   0124 18 08         [12]  308 	jr	00114$
                            309 ;src/State_InGame.c:123: case 6:{//PAUSE
   0126                     310 00113$:
                            311 ;src/State_InGame.c:124: statemanager_set_state(STATE_PAUSEMENU);
   0126 3E 02         [ 7]  312 	ld	a,#0x02
   0128 F5            [11]  313 	push	af
   0129 33            [ 6]  314 	inc	sp
   012A CDr00r00      [17]  315 	call	_statemanager_set_state
   012D 33            [ 6]  316 	inc	sp
                            317 ;src/State_InGame.c:127: }
   012E                     318 00114$:
                            319 ;src/State_InGame.c:128: ui_gamemenu_unselect_entry();
   012E CDr00r00      [17]  320 	call	_ui_gamemenu_unselect_entry
   0131                     321 00116$:
                            322 ;src/State_InGame.c:131: if(updateRenderBuffer){
   0131 3Ar1Ar00      [13]  323 	ld	a,(#_updateRenderBuffer + 0)
   0134 B7            [ 4]  324 	or	a, a
   0135 C8            [11]  325 	ret	Z
                            326 ;src/State_InGame.c:132: render_draw_to_buffer();
   0136 CDr00r00      [17]  327 	call	_render_draw_to_buffer
                            328 ;src/State_InGame.c:133: draw_minimap_to_buffer();
   0139 CDr00r00      [17]  329 	call	_draw_minimap_to_buffer
                            330 ;src/State_InGame.c:134: *(u8*)&updateRenderBuffer = 0;
   013C 21r1Ar00      [10]  331 	ld	hl,#_updateRenderBuffer
   013F 36 00         [10]  332 	ld	(hl),#0x00
   0141 C9            [10]  333 	ret
                            334 ;src/State_InGame.c:139: void state_ingame_render(){
                            335 ;	---------------------------------
                            336 ; Function state_ingame_render
                            337 ; ---------------------------------
   0142                     338 _state_ingame_render::
                            339 ;src/State_InGame.c:140: ui_gamemenu_render_refresh();
   0142 CDr00r00      [17]  340 	call	_ui_gamemenu_render_refresh
                            341 ;src/State_InGame.c:141: renderCompass();
   0145 CDr00r00      [17]  342 	call	_renderCompass
                            343 ;src/State_InGame.c:142: cpct_drawSprite(SCREEN_TEXTURE_BUFFER,SCREEN_TEXTURE_POSITION,SCREEN_TEXTURE_WIDTH_BYTES,SCREEN_TEXTURE_HEIGHT);
   0148 21 28 64      [10]  344 	ld	hl,#0x6428
   014B E5            [11]  345 	push	hl
   014C 21 B4 C0      [10]  346 	ld	hl,#0xC0B4
   014F E5            [11]  347 	push	hl
   0150 21 00 8B      [10]  348 	ld	hl,#0x8B00
   0153 E5            [11]  349 	push	hl
   0154 CDr00r00      [17]  350 	call	_cpct_drawSprite
                            351 ;src/State_InGame.c:143: cpct_drawSprite(MINIMAP_BUFFER,MINIMAP_POSITION,MINIMAP_WIDTH_BYTES,MINIMAP_HEIGHT_BYTES);
   0157 21 10 40      [10]  352 	ld	hl,#0x4010
   015A E5            [11]  353 	push	hl
   015B 21 22 C5      [10]  354 	ld	hl,#0xC522
   015E E5            [11]  355 	push	hl
   015F 21 A0 9A      [10]  356 	ld	hl,#0x9AA0
   0162 E5            [11]  357 	push	hl
   0163 CDr00r00      [17]  358 	call	_cpct_drawSprite
                            359 ;src/State_InGame.c:144: ui_playerstats_render();
   0166 CDr00r00      [17]  360 	call	_ui_playerstats_render
   0169 C9            [10]  361 	ret
                            362 ;src/State_InGame.c:147: void state_ingame_exit(){
                            363 ;	---------------------------------
                            364 ; Function state_ingame_exit
                            365 ; ---------------------------------
   016A                     366 _state_ingame_exit::
                            367 ;src/State_InGame.c:149: }
   016A C9            [10]  368 	ret
                            369 	.area _CODE
                            370 	.area _INITIALIZER
                            371 	.area _CABS (ABS)
